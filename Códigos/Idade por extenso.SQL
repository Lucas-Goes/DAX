/* Idade por extenso 
estudo de caso Tempo de empresa*/

TEMPO EMPRESA = 

VAR _TOTAL_DIAS = IF(HISTORICO[Data Demiss達o] = BLANK();DATEDIFF(HISTORICO[Data Admiss達o];TODAY();DAY);DATEDIFF(HISTORICO[Data Admiss達o];HISTORICO[Data Demiss達o];DAY))
VAR _TOTAL_ANOS = TRUNC(_TOTAL_DIAS/365,25)
VAR _DIAS_TOTAL_ANOS = _TOTAL_ANOS*365,25
VAR _DIAS_RESTANTES = TRUNC(_TOTAL_DIAS - _DIAS_TOTAL_ANOS)
VAR _TOTAL_MES = TRUNC(_DIAS_RESTANTES/30,41667)
VAR _DIAS_TOTAL_MES = TRUNC(_TOTAL_MES*30,41667)
VAR _TOTAL_DIAS_RESTANTES = _DIAS_RESTANTES - _DIAS_TOTAL_MES

RETURN 
IF(_TOTAL_ANOS < 1 && _TOTAL_MES >=1 ;  _TOTAL_MES & " MESES, " & _TOTAL_DIAS_RESTANTES & " DIAS";
    IF( _TOTAL_ANOS <1 && _TOTAL_MES <1; _TOTAL_DIAS_RESTANTES & " DIAS";
         _TOTAL_ANOS & " ANOS, " & _TOTAL_MES & " MESES, " & _TOTAL_DIAS_RESTANTES & " DIAS"))